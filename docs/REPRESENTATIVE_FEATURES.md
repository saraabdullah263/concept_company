# ูุธุงุฆู ุงูููุฏูุจ - Medical Waste Management System

## ูุธุฑุฉ ุนุงูุฉ

ุชู ุฅุถุงูุฉ ุฌููุน ุงููุธุงุฆู ุงููุทููุจุฉ ููููุฏูุจ ูุชูููุฐ ุงูุฑุญูุงุช ุจุดูู ูุงูู ูุน ุชุชุจุน ุงููููุน ูุงูููุช.

## ุงููููุงุช ุงููุถุงูุฉ

### 1. ุงูุตูุญุงุช (Pages)
- `src/pages/routes/RepresentativeRoute.jsx` - ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ ูุชูููุฐ ุงูุฑุญูุฉ

### 2. ุงูููููุงุช (Components)
- `src/components/routes/RouteStopCard.jsx` - ุจุทุงูุฉ ุงููุญุทุฉ ูุน ุฌููุน ุงููุธุงุฆู
- `src/components/routes/WeightEntryModal.jsx` - ูููุฐุฌ ุฅุฏุฎุงู ุงููุฒู
- `src/components/routes/PhotoUploadModal.jsx` - ูููุฐุฌ ุฑูุน ุงูุตูุฑ
- `src/components/routes/SignatureModal.jsx` - ูููุฐุฌ ุงูุชูููุน ุงูุฅููุชุฑููู
- `src/components/routes/RepresentativeRouteList.jsx` - ูุงุฆูุฉ ุงูุฑุญูุงุช ููููุฏูุจ

### 3. ูููุงุช SQL
- `setup_storage.sql` - ุฅุนุฏุงุฏ Storage ูู Supabase

## ุงููุธุงุฆู ุงููููุฐุฉ

### โ 1. ูููุฐุฌ ุชุณุฌูู ุงููุฒู ููู ูุญุทุฉ
- ุฅุฏุฎุงู ุงููุฒู ุจุงูููููุฌุฑุงู
- ุชุณุฌูู ููุช ุงูุฅุฏุฎุงู
- ุชุณุฌูู ูููุน GPS ุนูุฏ ุงูุฅุฏุฎุงู
- ุญูุธ ูู ุฌุฏูู `route_stops`
- ุชุณุฌูู ุงูุญุฏุซ ูู `route_tracking_logs`

### โ 2. ุฑูุน ุงูุตูุฑ
- ุงุฎุชูุงุฑ ุตูุฑุฉ ูู ุงููุงููุฑุง ุฃู ุงููุนุฑุถ
- ูุนุงููุฉ ุงูุตูุฑุฉ ูุจู ุงูุฑูุน
- ุฑูุน ุฅูู Supabase Storage
- ุญุฏ ุฃูุตู 5 ููุฌุงุจุงูุช
- ุชุณุฌูู ููุช ููููุน ุงูุฑูุน
- ุญูุธ ุฑุงุจุท ุงูุตูุฑุฉ ูู `route_stops.photo_proof`

### โ 3. ุงูุชูููุน ุงูุฅููุชุฑููู
- Canvas ููุฑุณู ุจุงููุงูุณ ุฃู ุงูุฅุตุจุน
- ุฅููุงููุฉ ุงููุณุญ ูุฅุนุงุฏุฉ ุงูุชูููุน
- ุญูุธ ุงูุชูููุน ูุตูุฑุฉ PNG
- ุฑูุน ุฅูู Supabase Storage
- ุชุณุฌูู ููุช ููููุน ุงูุชูููุน
- ุญูุธ ูู `route_stops.hospital_signature`

### โ 4. ุชุญุฏูุซ ุญุงูุฉ ุงูุฑุญูุฉ ูุงููุญุทุงุช
- **ุจุฏุก ุงูุฑุญูุฉ**: ุชุณุฌูู ููุช ููููุน ุงูุจุฏุงูุฉ
- **ุงููุตูู ูููุญุทุฉ**: ุชุณุฌูู ููุช ููููุน ุงููุตูู
- **ุงููุบุงุฏุฑุฉ ูู ุงููุญุทุฉ**: ุชุณุฌูู ููุช ููููุน ุงููุบุงุฏุฑุฉ
- **ุฅููุงุก ุงูุฑุญูุฉ**: ุชุณุฌูู ููุช ููููุน ุงูููุงูุฉ + ุงููุฒู ุงูููุงุฆู
- ุชุญุฏูุซ ุญุงูุฉ ุงููุญุทุงุช: pending โ arrived โ collected
- ุชุญุฏูุซ ุญุงูุฉ ุงูุฑุญูุฉ: pending โ in_progress โ completed

## ุณูุฑ ุงูุนูู (Workflow)

### 1. ุงูููุฏูุจ ููุชุญ ุงูุชุทุจูู
```
/routes โ ูุฑู ูุงุฆูุฉ ุฑุญูุงุชู
```

### 2. ูุฎุชุงุฑ ุฑุญูุฉ
```
ูุถุบุท ุนูู ุงูุฑุญูุฉ โ /routes/:routeId/execute
```

### 3. ูุจุฏุฃ ุงูุฑุญูุฉ
```
ูุถุบุท "ุจุฏุก ุงูุฑุญูุฉ" โ
  - ูุณุฌู ููุช ุงูุจุฏุงูุฉ
  - ูุณุฌู ูููุน GPS
  - ูุญุฏุซ ุงูุญุงูุฉ ุฅูู in_progress
```

### 4. ููู ูุญุทุฉ
```
1. ูุถุบุท "ูุตูุช" โ
   - ูุณุฌู ููุช ุงููุตูู
   - ูุณุฌู ูููุน GPS
   - ูุญุฏุซ ุงูุญุงูุฉ ุฅูู arrived
   - ุชุธูุฑ ุฎูุงุฑุงุช ุงูุฅุฌุฑุงุกุงุช

2. ูุฏุฎู ุงููุฒู โ
   - ููุชุญ ูููุฐุฌ ุงููุฒู
   - ูุฏุฎู ุงููุฒู ุจุงููููู
   - ูุญูุธ ูุน ุงูููุช ูุงููููุน

3. ูุฑูุน ุตูุฑุฉ (ุงุฎุชูุงุฑู) โ
   - ูุฎุชุงุฑ ุตูุฑุฉ
   - ูุฑูุนูุง ุฅูู Storage
   - ุชุญูุธ ูุน ุงูููุช ูุงููููุน

4. ูุฃุฎุฐ ุงูุชูููุน โ
   - ููุชุญ ูููุฐุฌ ุงูุชูููุน
   - ูููุน ุงููุณุคูู
   - ูุญูุธ ูุน ุงูููุช ูุงููููุน

5. ูุถุบุท "ูุบุงุฏุฑุฉ" โ
   - ูุณุฌู ููุช ุงููุบุงุฏุฑุฉ
   - ูุณุฌู ูููุน GPS
   - ูุญุฏุซ ุงูุญุงูุฉ ุฅูู collected
```

### 5. ุงููุญุฑูุฉ (ุงููุญุทุฉ ุงูุฃุฎูุฑุฉ)
```
ุจุนุฏ ุฅููุงู ุฌููุน ุงููุญุทุงุช โ
  - ุชุธูุฑ ูููุฐุฌ ุงููุญุฑูุฉ
  - ูุฏุฎู ุงููุฒู ุงูููุงุฆู
  - ูุถุบุท "ุฅููุงุก ุงูุฑุญูุฉ"
  - ูุณุฌู ููุช ููููุน ุงูููุงูุฉ
  - ูุญุฏุซ ุงูุญุงูุฉ ุฅูู completed
```

## ุงูุจูุงูุงุช ุงููุณุฌูุฉ

### ูู ุฌุฏูู `routes`
```sql
- start_time: ููุช ุจุฏุก ุงูุฑุญูุฉ
- start_location: ูููุน GPS ุนูุฏ ุงูุจุฏุงูุฉ
- end_time: ููุช ุงูุชูุงุก ุงูุฑุญูุฉ
- end_location: ูููุน GPS ุนูุฏ ุงูููุงูุฉ
- total_weight_collected: ุฅุฌูุงูู ุงููุฒู ุงููุฌูุน
- final_weight_at_incinerator: ุงููุฒู ุงูููุงุฆู ูู ุงููุญุฑูุฉ
- status: pending/in_progress/completed
```

### ูู ุฌุฏูู `route_stops`
```sql
- arrival_time: ููุช ุงููุตูู
- arrival_location: ูููุน GPS ุนูุฏ ุงููุตูู
- departure_time: ููุช ุงููุบุงุฏุฑุฉ
- departure_location: ูููุน GPS ุนูุฏ ุงููุบุงุฏุฑุฉ
- weight_collected: ุงููุฒู ุงููุฌูุน
- weight_entry_time: ููุช ุฅุฏุฎุงู ุงููุฒู
- weight_entry_location: ูููุน GPS ุนูุฏ ุฅุฏุฎุงู ุงููุฒู
- photo_proof: ุฑุงุจุท ุงูุตูุฑุฉ
- photo_upload_time: ููุช ุฑูุน ุงูุตูุฑุฉ
- photo_upload_location: ูููุน GPS ุนูุฏ ุฑูุน ุงูุตูุฑุฉ
- hospital_signature: ุงูุชูููุน (JSON ูุน ุฑุงุจุท ุงูุตูุฑุฉ)
- signature_time: ููุช ุงูุชูููุน
- signature_location: ูููุน GPS ุนูุฏ ุงูุชูููุน
- status: pending/arrived/collected
```

### ูู ุฌุฏูู `route_tracking_logs`
```sql
- route_id: ูุนุฑู ุงูุฑุญูุฉ
- route_stop_id: ูุนุฑู ุงููุญุทุฉ (ุฅู ูุฌุฏ)
- event_type: ููุน ุงูุญุฏุซ
  * route_started
  * arrived_hospital
  * departed_hospital
  * weight_entered
  * photo_uploaded
  * signature_taken
  * route_completed
- event_time: ููุช ุงูุญุฏุซ
- location: ูููุน GPS {lat, lng, accuracy}
- data: ุจูุงูุงุช ุฅุถุงููุฉ (JSON)
```

## ุฅุนุฏุงุฏ Supabase Storage

### 1. ุชุดุบูู SQL
```sql
-- ูู Supabase SQL Editor
-- ููุฐ ูุญุชูู ููู setup_storage.sql
```

### 2. ุงูุชุญูู ูู Bucket
```
1. ุงูุชุญ Supabase Dashboard
2. ุงุฐูุจ ุฅูู Storage
3. ุชุฃูุฏ ูู ูุฌูุฏ bucket ุงุณูู "medical-waste"
4. ุชุฃูุฏ ูู ุฃูู public
```

### 3. ุงููุฌูุฏุงุช ุงููุทููุจุฉ
```
medical-waste/
  โโโ route-photos/     (ุตูุฑ ุงููุญุทุงุช)
  โโโ signatures/       (ุงูุชูููุนุงุช)
```

## ุงูุฃุฐููุงุช ุงููุทููุจุฉ

### ูู ุงููุชุตูุญ
```javascript
// Location Permission
navigator.geolocation.getCurrentPosition()

// Camera Permission (ููุตูุฑ)
<input type="file" accept="image/*" capture="environment" />
```

### ูู Supabase
```sql
-- RLS Policies
- Allow authenticated users to upload
- Allow authenticated users to read
- Allow public to read (bucket is public)
```

## ุงูุงุฎุชุจุงุฑ

### 1. ุฅูุดุงุก ุฑุญูุฉ ููููุฏูุจ
```
1. ุณุฌู ุฏุฎูู ูู Admin/Logistics Manager
2. ุงุฐูุจ ุฅูู /routes
3. ุฃูุดุฆ ุฑุญูุฉ ุฌุฏูุฏุฉ
4. ุงุฎุชุฑ ููุฏูุจ
5. ุฃุถู ูุญุทุงุช
6. ุงุญูุธ
```

### 2. ุชูููุฐ ุงูุฑุญูุฉ
```
1. ุณุฌู ุฏุฎูู ูู Representative
2. ุงุฐูุจ ุฅูู /routes
3. ุงุฎุชุฑ ุงูุฑุญูุฉ
4. ุงุจุฏุฃ ุงูุฑุญูุฉ
5. ููุฐ ูู ูุญุทุฉ:
   - ูุตูุช
   - ุฃุฏุฎู ุงููุฒู
   - ุงุฑูุน ุตูุฑุฉ
   - ุฎุฐ ุงูุชูููุน
   - ุบุงุฏุฑ
6. ุฃููู ุงูุฑุญูุฉ ูู ุงููุญุฑูุฉ
```

### 3. ุงูุชุญูู ูู ุงูุจูุงูุงุช
```sql
-- ูู Supabase SQL Editor

-- ุชุญูู ูู ุจูุงูุงุช ุงูุฑุญูุฉ
SELECT * FROM routes WHERE id = 'route_id';

-- ุชุญูู ูู ุจูุงูุงุช ุงููุญุทุงุช
SELECT * FROM route_stops WHERE route_id = 'route_id';

-- ุชุญูู ูู ุณุฌู ุงูุชุชุจุน
SELECT * FROM route_tracking_logs WHERE route_id = 'route_id';

-- ุชุญูู ูู ุงูุตูุฑ
SELECT * FROM storage.objects WHERE bucket_id = 'medical-waste';
```

## ุงูููุฒุงุช ุงูุฅุถุงููุฉ

### 1. ุงูุชุญูู ูู ุงููููุน
- ูุทูุจ ุฅุฐู ุงููููุน ุนูุฏ ูุชุญ ุงูุตูุญุฉ
- ูุนุฑุถ ุชูุจูู ุฅุฐุง ูุงู ุงููููุน ูุนุทู
- ูููุน ุงูุฅุฌุฑุงุกุงุช ุจุฏูู ูููุน

### 2. ูุงุฌูุฉ ุณููุฉ
- ุจุทุงูุงุช ูุงุถุญุฉ ููู ูุญุทุฉ
- ุฃููููุงุช ูุนุจุฑุฉ
- ุฃููุงู ูููุฒุฉ ููุญุงูุงุช
- ุฑุณุงุฆู ูุงุถุญุฉ

### 3. ุดุฑูุท ุงูุชูุฏู
- ูุนุฑุถ ุนุฏุฏ ุงููุญุทุงุช ุงูููุชููุฉ
- ูุณุจุฉ ุงูุฅูุฌุงุฒ
- ุงููุฒู ุงูุฅุฌูุงูู ุงููุฌูุน

### 4. ุงูุชุญูู ูู ุงูุฅููุงู
- ูุง ูููู ุงููุบุงุฏุฑุฉ ุจุฏูู:
  * ุฅุฏุฎุงู ุงููุฒู
  * ุงูุชูููุน ุงูุฅููุชุฑููู
- ุงูุตูุฑุฉ ุงุฎุชูุงุฑูุฉ

## ุงูุฎุทูุงุช ุงูุชุงููุฉ (ุงุฎุชูุงุฑู)

### 1. ูุธุงู ุงูุชุฃุฎูุฑ
- ุญุณุงุจ ุงูุชุฃุฎูุฑ ุชููุงุฆูุงู
- ุฅุดุนุงุฑุงุช ุนูุฏ ุงูุชุฃุฎูุฑ
- ุทูุจ ุณุจุจ ุงูุชุฃุฎูุฑ

### 2. ุงูุฎุฑุงุฆุท
- ุนุฑุถ ุงููุณุงุฑ ุนูู ุฎุฑูุทุฉ
- ุงูุชููู ุฅูู ุงููุญุทุฉ ุงูุชุงููุฉ
- ุชุชุจุน ุงููููุน ูู ุงูููุช ุงููุนูู

### 3. Offline Mode
- ุญูุธ ุงูุจูุงูุงุช ูุญููุงู
- ุงููุฒุงููุฉ ุนูุฏ ุนูุฏุฉ ุงูุงุชุตุงู
- Service Workers

### 4. ุงูุฅุดุนุงุฑุงุช
- Push Notifications
- ุชูุจููุงุช ุงูุฑุญูุงุช ุงูุฌุฏูุฏุฉ
- ุชุฐููุฑุงุช

## ุงูุฏุนู

ุฅุฐุง ูุงุฌูุช ุฃู ูุดุงูู:

1. **ุงููููุน ูุง ูุนูู**
   - ุชุฃูุฏ ูู ุชูุนูู GPS
   - ุงููุญ ุฅุฐู ุงููููุน ูููุชุตูุญ
   - ุฌุฑุจ ูู HTTPS (ูุทููุจ ูููููุน)

2. **ุงูุตูุฑ ูุง ุชุฑูุน**
   - ุชุฃูุฏ ูู ุฅุนุฏุงุฏ Storage
   - ุชุญูู ูู ุงูู Policies
   - ุชุฃูุฏ ูู ุญุฌู ุงูุตูุฑุฉ < 5MB

3. **ุงูุชูููุน ูุง ูุนูู**
   - ุฌุฑุจ ุนูู ุดุงุดุฉ ููุณ
   - ุฃู ุงุณุชุฎุฏู ุงููุงูุณ
   - ุชุฃูุฏ ูู Canvas ูุฏุนูู

## ุงูุฎูุงุตุฉ

ุชู ุชูููุฐ ุฌููุน ุงููุธุงุฆู ุงููุทููุจุฉ:
- โ ูููุฐุฌ ุชุณุฌูู ุงููุฒู
- โ ุฑูุน ุงูุตูุฑ (Storage)
- โ ุงูุชูููุน ุงูุฅููุชุฑููู (Canvas)
- โ ุชุญุฏูุซ ุญุงูุฉ ุงูุฑุญูุฉ ูุงููุญุทุงุช
- โ ุชุณุฌูู ุงูููุช ูุงููููุน ููู ุฅุฌุฑุงุก
- โ ูุงุฌูุฉ ุณููุฉ ูููุธูุฉ

ุงููุธุงู ุฌุงูุฒ ููุงุฎุชุจุงุฑ! ๐
